# 文件重命名功能测试指南

## 功能说明
新增了一个文件重命名配置开关，用于控制上传文件的命名策略：
- **关闭（默认）**：保持原文件名，同名文件会被直接替换
- **开启**：使用Hash重命名，避免文件名冲突

## 测试步骤

### 1. 测试默认行为（关闭重命名）
1. 打开版本发布弹窗
2. 确认"文件重命名"开关处于关闭状态（显示"保持原文件名"）
3. 上传一个测试文件，例如 `test-app-v1.0.0.zip`
4. 发布版本
5. 检查服务器 `/uploads` 目录，文件应该保存为 `test-app-v1.0.0.zip`
6. 再次上传同名文件，确认会直接替换旧文件

### 2. 测试Hash重命名功能
1. 打开版本发布弹窗
2. 将"文件重命名"开关设置为开启状态（显示"启用Hash重命名"）
3. 上传同一个测试文件 `test-app-v1.0.0.zip`
4. 发布版本
5. 检查服务器 `/uploads` 目录，文件应该保存为类似 `file-1234567890-123456789.zip` 的Hash名称
6. 多次上传同名文件，确认每次都生成不同的Hash文件名

### 3. 测试中文文件名
1. 准备一个中文文件名的测试文件，例如 `测试应用程序.zip`
2. 分别在开启和关闭重命名的情况下上传
3. 确认中文文件名能正确处理和显示

### 4. 验证下载功能
1. 对于保持原文件名的版本，下载时应该使用原始文件名
2. 对于Hash重命名的版本，下载时仍应该使用原始文件名（通过 `originalFileName` 字段）

## 技术实现要点

### 前端
- 在发布弹窗中添加了 Switch 组件控制重命名选项
- 通过 FormData 将 `enableRename` 参数传递给后端
- 默认值为 `false`（关闭重命名）

### 后端
- 修改了 multer 的 `filename` 配置，根据 `enableRename` 参数决定文件命名策略
- 关闭时直接使用修复编码后的原始文件名
- 开启时使用时间戳+随机数的Hash命名
- 添加了调试日志输出重命名配置和文件名信息

## 预期结果
- 默认情况下保持原文件名，便于文件管理
- 开启Hash重命名时避免文件冲突
- 中文文件名能正确处理
- 下载时始终使用用户友好的原始文件名
